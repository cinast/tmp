"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SVGAssetManager = void 0;
const cc_1 = require("cc");
const SVGAssets_1 = require("./SVGAssets");
class SVGAssetManager {
    /**
     * 初始化自定义资源系统
     */
    static init() {
        // 确保只初始化一次
        if (this._initialized)
            return;
        // 初始化下载器和解析器
        // 需要在适当的时机调用 CustomFileDownloader.init() 和 CustomFileParser.init()
        this._initialized = true;
        console.log("svgAssetManager initialized");
    }
    /**
     * 加载自定义文件（通用接口）
     */
    static loadSVGFile(urlOrUuids, options = {}) {
        return new Promise((resolve, reject) => {
            const requestOptions = Object.assign({ ext: ".svg" }, options);
            // 添加自定义元数据
            if (options.metadata) {
                requestOptions.metadata = options.metadata;
            }
            cc_1.assetManager.loadAny(urlOrUuids, (err, data) => {
                if (err) {
                    reject(err);
                }
                else {
                    resolve(data);
                }
            });
        });
    }
    /**
     * 从远程加载自定义文件
     */
    static loadRemoteCustomFile(url, options = {}) {
        return new Promise((resolve, reject) => {
            cc_1.assetManager.loadRemote(url, Object.assign({ ext: ".svg" }, options), (err, asset) => {
                if (err) {
                    reject(err);
                }
                else if (!asset) {
                    reject(new Error("Asset is null"));
                }
                else {
                    resolve(asset);
                }
            });
        });
    }
    /**
     * 保存自定义资源
     */
    static async saveSVGAsset(asset, options = {}) {
        if (!(0, cc_1.isValid)(asset)) {
            throw new Error("Invalid asset");
        }
        // 生成数据字符串
        const dataStr = asset.svgContent;
        // 如果需要下载文件
        if (options.download) {
            return this.downloadFile(dataStr, options.filename || "custom-asset.svg");
        }
        // 否则返回数据字符串
        return dataStr;
    }
    /**
     * 下载文件到本地
     */
    static downloadFile(data, filename) {
        if (typeof window === "undefined")
            return;
        const blob = new Blob([data], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }, 100);
    }
    /**
     * 释放自定义资源
     */
    static releaseSVGAsset(asset) {
        if (asset && (0, cc_1.isValid)(asset)) {
            cc_1.assetManager.releaseAsset(asset);
        }
    }
    /**
     * 获取所有已加载的自定义资源
     */
    static getLoadedSVGAssets() {
        const assets = [];
        // 遍历所有已加载的资源
        cc_1.assetManager.assets.forEach((asset) => {
            if (asset instanceof SVGAssets_1.SVGAsset) {
                assets.push(asset);
            }
        });
        return assets;
    }
    /**
     * 检查资源是否已加载
     */
    static isAssetLoaded(uuidOrUrl) {
        return cc_1.assetManager.assets.has(uuidOrUrl);
    }
}
exports.SVGAssetManager = SVGAssetManager;
SVGAssetManager._initialized = false;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXRNYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc291cmNlL2Fzc2V0TWFuYWdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwyQkFBa0Q7QUFDbEQsMkNBQXVDO0FBRXZDLE1BQWEsZUFBZTtJQUN4Qjs7T0FFRztJQUNILE1BQU0sQ0FBQyxJQUFJO1FBQ1AsV0FBVztRQUNYLElBQUksSUFBSSxDQUFDLFlBQVk7WUFBRSxPQUFPO1FBRTlCLGFBQWE7UUFDYixtRUFBbUU7UUFFbkUsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7UUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFJRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxXQUFXLENBQ2QsVUFBb0IsRUFDcEIsVUFHSSxFQUFFO1FBRU4sT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUNuQyxNQUFNLGNBQWMsbUJBQ2hCLEdBQUcsRUFBRSxNQUFNLElBQ1IsT0FBTyxDQUNiLENBQUM7WUFFRixXQUFXO1lBQ1gsSUFBSSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ25CLGNBQWMsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztZQUMvQyxDQUFDO1lBRUQsaUJBQVksQ0FBQyxPQUFPLENBQUksVUFBVSxFQUFFLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO2dCQUM5QyxJQUFJLEdBQUcsRUFBRSxDQUFDO29CQUNOLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDaEIsQ0FBQztxQkFBTSxDQUFDO29CQUNKLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDbEIsQ0FBQztZQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsb0JBQW9CLENBQ3ZCLEdBQVcsRUFDWCxVQUdJLEVBQUU7UUFFTixPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ25DLGlCQUFZLENBQUMsVUFBVSxDQUNuQixHQUFHLGtCQUVDLEdBQUcsRUFBRSxNQUFNLElBQ1IsT0FBTyxHQUVkLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFO2dCQUNYLElBQUksR0FBRyxFQUFFLENBQUM7b0JBQ04sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNoQixDQUFDO3FCQUFNLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDaEIsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZDLENBQUM7cUJBQU0sQ0FBQztvQkFDSixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ25CLENBQUM7WUFDTCxDQUFDLENBQ0osQ0FBQztRQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQ3JCLEtBQWUsRUFDZixVQUdJLEVBQUU7UUFFTixJQUFJLENBQUMsSUFBQSxZQUFPLEVBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNsQixNQUFNLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3JDLENBQUM7UUFFRCxVQUFVO1FBQ1YsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQztRQUVqQyxXQUFXO1FBQ1gsSUFBSSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbkIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsUUFBUSxJQUFJLGtCQUFrQixDQUFDLENBQUM7UUFDOUUsQ0FBQztRQUVELFlBQVk7UUFDWixPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRUQ7O09BRUc7SUFDSyxNQUFNLENBQUMsWUFBWSxDQUFDLElBQVksRUFBRSxRQUFnQjtRQUN0RCxJQUFJLE9BQU8sTUFBTSxLQUFLLFdBQVc7WUFBRSxPQUFPO1FBRTFDLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztRQUN0RCxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXRDLE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7UUFDYixDQUFDLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN0QixRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QixDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7UUFFVixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0IsR0FBRyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUM3QixDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDWixDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQVk7UUFDL0IsSUFBSSxLQUFLLElBQUksSUFBQSxZQUFPLEVBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUMxQixpQkFBWSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNyQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLGtCQUFrQjtRQUNyQixNQUFNLE1BQU0sR0FBZSxFQUFFLENBQUM7UUFFOUIsYUFBYTtRQUNiLGlCQUFZLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQVksRUFBRSxFQUFFO1lBQ3pDLElBQUksS0FBSyxZQUFZLG9CQUFRLEVBQUUsQ0FBQztnQkFDNUIsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2QixDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsYUFBYSxDQUFDLFNBQWlCO1FBQ2xDLE9BQU8saUJBQVksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQzlDLENBQUM7O0FBM0pMLDBDQTRKQztBQTdJa0IsNEJBQVksR0FBRyxLQUFLLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhc3NldE1hbmFnZXIsIEFzc2V0LCBpc1ZhbGlkIH0gZnJvbSBcImNjXCI7XHJcbmltcG9ydCB7IFNWR0Fzc2V0IH0gZnJvbSBcIi4vU1ZHQXNzZXRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU1ZHQXNzZXRNYW5hZ2VyIHtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW6Ieq5a6a5LmJ6LWE5rqQ57O757ufXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBpbml0KCkge1xyXG4gICAgICAgIC8vIOehruS/neWPquWIneWni+WMluS4gOasoVxyXG4gICAgICAgIGlmICh0aGlzLl9pbml0aWFsaXplZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvLyDliJ3lp4vljJbkuIvovb3lmajlkozop6PmnpDlmahcclxuICAgICAgICAvLyDpnIDopoHlnKjpgILlvZPnmoTml7bmnLrosIPnlKggQ3VzdG9tRmlsZURvd25sb2FkZXIuaW5pdCgpIOWSjCBDdXN0b21GaWxlUGFyc2VyLmluaXQoKVxyXG5cclxuICAgICAgICB0aGlzLl9pbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJzdmdBc3NldE1hbmFnZXIgaW5pdGlhbGl6ZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2luaXRpYWxpemVkID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3oh6rlrprkuYnmlofku7bvvIjpgJrnlKjmjqXlj6PvvIlcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGxvYWRTVkdGaWxlPFQgZXh0ZW5kcyBTVkdBc3NldD4oXHJcbiAgICAgICAgdXJsT3JVdWlkczogc3RyaW5nW10sXHJcbiAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICB0eXBlPzogYW55O1xyXG4gICAgICAgICAgICBtZXRhZGF0YT86IGFueTtcclxuICAgICAgICB9ID0ge31cclxuICAgICk6IFByb21pc2U8VFtdPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdE9wdGlvbnM6IGFueSA9IHtcclxuICAgICAgICAgICAgICAgIGV4dDogXCIuc3ZnXCIsXHJcbiAgICAgICAgICAgICAgICAuLi5vcHRpb25zLFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8g5re75Yqg6Ieq5a6a5LmJ5YWD5pWw5o2uXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLm1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0T3B0aW9ucy5tZXRhZGF0YSA9IG9wdGlvbnMubWV0YWRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFzc2V0TWFuYWdlci5sb2FkQW55PFQ+KHVybE9yVXVpZHMsIChlcnIsIGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDku47ov5znqIvliqDovb3oh6rlrprkuYnmlofku7ZcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGxvYWRSZW1vdGVDdXN0b21GaWxlPFQgZXh0ZW5kcyBTVkdBc3NldD4oXHJcbiAgICAgICAgdXJsOiBzdHJpbmcsXHJcbiAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICBvblByb2dyZXNzPzogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWQ7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhPzogYW55O1xyXG4gICAgICAgIH0gPSB7fVxyXG4gICAgKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgYXNzZXRNYW5hZ2VyLmxvYWRSZW1vdGU8VD4oXHJcbiAgICAgICAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXh0OiBcIi5zdmdcIixcclxuICAgICAgICAgICAgICAgICAgICAuLi5vcHRpb25zLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIChlcnIsIGFzc2V0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFhc3NldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQXNzZXQgaXMgbnVsbFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhc3NldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5L+d5a2Y6Ieq5a6a5LmJ6LWE5rqQXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBzYXZlU1ZHQXNzZXQoXHJcbiAgICAgICAgYXNzZXQ6IFNWR0Fzc2V0LFxyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgZmlsZW5hbWU/OiBzdHJpbmc7XHJcbiAgICAgICAgICAgIGRvd25sb2FkPzogYm9vbGVhbjtcclxuICAgICAgICB9ID0ge31cclxuICAgICk6IFByb21pc2U8c3RyaW5nIHwgdm9pZD4ge1xyXG4gICAgICAgIGlmICghaXNWYWxpZChhc3NldCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhc3NldFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOeUn+aIkOaVsOaNruWtl+espuS4slxyXG4gICAgICAgIGNvbnN0IGRhdGFTdHIgPSBhc3NldC5zdmdDb250ZW50O1xyXG5cclxuICAgICAgICAvLyDlpoLmnpzpnIDopoHkuIvovb3mlofku7ZcclxuICAgICAgICBpZiAob3B0aW9ucy5kb3dubG9hZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kb3dubG9hZEZpbGUoZGF0YVN0ciwgb3B0aW9ucy5maWxlbmFtZSB8fCBcImN1c3RvbS1hc3NldC5zdmdcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDlkKbliJnov5Tlm57mlbDmja7lrZfnrKbkuLJcclxuICAgICAgICByZXR1cm4gZGF0YVN0cjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS4i+i9veaWh+S7tuWIsOacrOWcsFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyBkb3dubG9hZEZpbGUoZGF0YTogc3RyaW5nLCBmaWxlbmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwgeyB0eXBlOiBcInRleHQvcGxhaW5cIiB9KTtcclxuICAgICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cclxuICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcbiAgICAgICAgYS5ocmVmID0gdXJsO1xyXG4gICAgICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZTtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xyXG4gICAgICAgIGEuY2xpY2soKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7XHJcbiAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YeK5pS+6Ieq5a6a5LmJ6LWE5rqQXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyByZWxlYXNlU1ZHQXNzZXQoYXNzZXQ6IEFzc2V0KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKGFzc2V0ICYmIGlzVmFsaWQoYXNzZXQpKSB7XHJcbiAgICAgICAgICAgIGFzc2V0TWFuYWdlci5yZWxlYXNlQXNzZXQoYXNzZXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaJgOacieW3suWKoOi9veeahOiHquWumuS5iei1hOa6kFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZ2V0TG9hZGVkU1ZHQXNzZXRzKCk6IFNWR0Fzc2V0W10ge1xyXG4gICAgICAgIGNvbnN0IGFzc2V0czogU1ZHQXNzZXRbXSA9IFtdO1xyXG5cclxuICAgICAgICAvLyDpgY3ljobmiYDmnInlt7LliqDovb3nmoTotYTmupBcclxuICAgICAgICBhc3NldE1hbmFnZXIuYXNzZXRzLmZvckVhY2goKGFzc2V0OiBBc3NldCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYXNzZXQgaW5zdGFuY2VvZiBTVkdBc3NldCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXRzLnB1c2goYXNzZXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBhc3NldHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmo4Dmn6XotYTmupDmmK/lkKblt7LliqDovb1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGlzQXNzZXRMb2FkZWQodXVpZE9yVXJsOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gYXNzZXRNYW5hZ2VyLmFzc2V0cy5oYXModXVpZE9yVXJsKTtcclxuICAgIH1cclxufVxyXG4iXX0=